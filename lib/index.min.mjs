#!/usr/bin/env node
var p=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var m=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var k=m((X,R)=>{R.exports={en:{intro:"\u{1F680} NPM Script Runner",selectProject:"\u{1F4C1} Select project location",projectPathRequired:"Project path is required!",noPackageJson:"No package.json found in the selected path!",noScripts:"No available scripts found.",selectScript:"\u{1F527} Select a script to run:",runLastScript:"Do you want to run the last script",running:"\u{1F4E6} Running script:",success:"\u2705 Script executed successfully!",failure:"\u274C Script execution failed, exit code:",interrupted:"\u{1F6D1} Script interrupted by user",thanks:"Thank you for using NPM Script Runner",operationCancelled:"Operation cancelled",helpTitle:"\u{1F680} NPM Script Runner (nrs) Help",availableCommands:"Available commands:",showHelp:"Show this help information",listScripts:"List and select scripts to run",advancedMode:"Enter advanced mode: select project path and run scripts",searchScripts:"Search for scripts and run matching ones",runRecentScript:"Run the most recently used script",runRecentScriptN:"Run the nth most recently used script",listRecentScripts:"View the list of recently used scripts",listAllScripts:"Display all available scripts",examples:"Examples:",searchScriptsTest:"Search for scripts containing 'test' and run",runRecentScript2:"Run the 2nd most recently used script",changeLanguage:"Change the display language (available: en, zh)",languageChanged:"Language changed to English",unsupportedLanguage:"Unsupported language. Please use 'en' for English or 'zh' for Chinese.",recentCommands:"Recently used scripts in",noRecentScript:"No recent script found at index",availableScripts:"Available scripts:",version:"NPM Script Runner version:"},zh:{intro:"\u{1F680} NPM \u811A\u672C\u8FD0\u884C\u5668",selectProject:"\u{1F4C1} \u9009\u62E9\u9879\u76EE\u4F4D\u7F6E",projectPathRequired:"\u9879\u76EE\u8DEF\u5F84\u5FC5\u586B\uFF01",noPackageJson:"\u6240\u9009\u8DEF\u5F84\u4E0B\u6CA1\u6709\u627E\u5230 package.json \u6587\u4EF6\uFF01",noScripts:"\u6CA1\u6709\u627E\u5230\u53EF\u7528\u7684\u811A\u672C\u3002",selectScript:"\u{1F527} \u9009\u62E9\u8981\u8FD0\u884C\u7684\u811A\u672C:",runLastScript:"\u662F\u5426\u8FD0\u884C\u4E0A\u6B21\u7684\u811A\u672C",running:"\u{1F4E6} \u6B63\u5728\u8FD0\u884C\u811A\u672C:",success:"\u2705 \u811A\u672C\u6267\u884C\u6210\u529F\uFF01",failure:"\u274C \u811A\u672C\u6267\u884C\u5931\u8D25\uFF0C\u9000\u51FA\u7801:",interrupted:"\u{1F6D1} \u811A\u672C\u88AB\u7528\u6237\u4E2D\u65AD",thanks:"\u611F\u8C22\u4F7F\u7528 NPM \u811A\u672C\u8FD0\u884C\u5668",operationCancelled:"\u64CD\u4F5C\u5DF2\u53D6\u6D88",version:"NPM \u811A\u672C\u8FD0\u884C\u5668\u7248\u672C\uFF1A",changeLanguage:"\u66F4\u6539\u663E\u793A\u8BED\u8A00\uFF08\u53EF\u7528\uFF1Aen, zh\uFF09",languageChanged:"\u8BED\u8A00\u5DF2\u66F4\u6539\u4E3A\u4E2D\u6587"}}});var h=m((Y,J)=>{J.exports={name:"scriptz-cli",version:"0.0.3",description:"A CLI tool to visualize and run npm scripts",main:"lib/index.cjs",module:"lib/index.mjs",exports:{".":{require:"./lib/index.cjs",import:"./lib/index.mjs"}},bin:{nrs:"lib/index.cjs"},scripts:{start:"node run-script.js",build:"node build.js",prepublishOnly:"npm run build"},files:["lib","README.md","README.zh-cn.md","demo.png","LICENSE"],dependencies:{"@clack/prompts":"^0.7.0",commander:"^12.1.0",picocolors:"^1.1.0"},devDependencies:{esbuild:"^0.19.0"},keywords:["npm","scripts","cli","tool"],author:"zzcyes",license:"MIT",repository:{type:"git",url:"https://github.com/zzcyes/scriptz-cli.git"},bugs:{url:"https://github.com/zzcyes/scriptz-cli/issues"},homepage:"https://github.com/zzcyes/scriptz-cli#readme"}});var K=m((Z,A)=>{var{Command:T}=p("commander"),{intro:H,outro:l,select:P,confirm:D,isCancel:S,text:F}=p("@clack/prompts"),{readFileSync:v,writeFileSync:V,existsSync:N}=p("fs"),{spawn:G}=p("child_process"),s=p("picocolors"),w=p("path"),W=k(),L="en",e=n=>W[L][n]||n,g=new T,f=w.join(__dirname,".script-history.json"),b=()=>N(f)?JSON.parse(v(f,"utf8")):{},M=(n,t)=>{var c;let r=b();r[n]=[t,...((c=r[n])==null?void 0:c.filter(o=>o!==t))||[]].slice(0,10),V(f,JSON.stringify(r,null,2))},C=n=>b()[n]||[],_=(n,t)=>C(n)[t]||null,U=n=>{let t=C(n);console.log(s.cyan(`
${e("recentCommands")}: ${n}`)),t.forEach((r,c)=>{console.log(`  ${s.yellow(c+1)}: ${s.green(r)}`)})},q=async n=>{if(!n)return process.cwd();let t=await F({message:e("selectProject"),initialValue:process.cwd(),validate:r=>{if(!r||r.length===0)return e("projectPathRequired");if(!N(w.join(r,"package.json")))return e("noPackageJson")}});return S(t)&&(l(s.yellow(e("operationCancelled"))),process.exit(0)),t},E=n=>{let t=JSON.parse(v(w.join(n,"package.json"),"utf8")).scripts||{};return Object.keys(t).length===0&&(l(s.yellow(e("noScripts"))),process.exit(0)),t},B=n=>Object.entries(n).map(([t,r])=>({value:t,label:`${s.green(t)} ${s.dim(`- ${r}`)}`})),z=async(n,t,r)=>{if(r){let c=n.filter(a=>a.value.toLowerCase().includes(r.toLowerCase()));c.length===0&&(console.log(s.yellow(e("noMatchingScripts"))),process.exit(0));let o=await P({message:e("selectMatchingScript"),options:c});return S(o)&&(l(s.yellow(e("operationCancelled"))),process.exit(0)),o}if(t){let c=await P({message:e("selectScript"),options:n});return S(c)&&(l(s.yellow(e("operationCancelled"))),process.exit(0)),c}},O=(n,t)=>{t||(l(s.yellow(e("noScriptSelected"))),process.exit(0)),console.log(`
${e("running")} ${s.cyan(t)}`);let r=G("npm",["run",t],{stdio:"inherit",shell:!0,cwd:n});r.on("exit",c=>{console.log(c===0?`
${e("success")}`:`
${e("failure")} ${c}`),l(s.bgCyan(` ${e("thanks")} `))}),process.on("SIGINT",()=>{r.kill("SIGINT"),console.log(`
${e("interrupted")}`),l(s.bgCyan(` ${e("thanks")} `)),process.exit(0)})},y=async(n={})=>{let{searchTerm:t,advanced:r,listOnly:c,recentIndex:o}=n;H(`${s.bold(s.cyan(e("intro")))} ${s.dim(h().version)}`);let a=await q(r),u=E(a),j=B(u),i;if(o!==void 0)i=_(a,o),i||(l(s.yellow(`${e("noRecentScript")} ${o+1}.`)),process.exit(0));else if(t)i=await z(j,!1,t);else if(!c){let d=C(a);if(d.length>0&&u[d[0]]){let x=await D({message:`${e("runLastScript")} "${s.cyan(d[0])}"?`});S(x)&&(l(s.yellow(e("operationCancelled"))),process.exit(0)),x&&(i=d[0])}}return i||(i=await z(j,c)),i?(M(a,i),O(a,i)):(l(s.bgCyan(` ${e("thanks")} `)),process.exit(0)),i},$=()=>{console.log(s.cyan(`
${e("helpTitle")}`)),console.log(s.dim(`
${e("availableCommands")}`)),console.log(`  ${s.green("nrs")}               ${e("listScripts")}`),console.log(`  ${s.green("nrs -l")}            ${e("listScripts")}`),console.log(`  ${s.green("nrs -la")}           ${e("advancedMode")}`),console.log(`  ${s.green("nrs -s <keyword>")}  ${e("searchScripts")}`),console.log(`  ${s.green("nrs -r")}            ${e("runRecentScript")}`),console.log(`  ${s.green("nrs -r --<n>")}      ${e("runRecentScriptN")}`),console.log(`  ${s.green("nrs -rl")}           ${e("listRecentScripts")}`),console.log(`  ${s.green("nrs --list-all")}    ${e("listAllScripts")}`),console.log(`  ${s.green("nrs --help")}        ${e("showHelp")}`),console.log(s.dim(`
${e("examples")}`)),console.log(`  ${s.green("nrs -l")}            ${e("listScripts")}`),console.log(`  ${s.green("nrs -la")}           ${e("advancedMode")}`),console.log(`  ${s.green("nrs -s test")}       ${e("searchScriptsTest")}`),console.log(`  ${s.green("nrs -r --2")}        ${e("runRecentScript2")}`),console.log(`  ${s.green("nrs -v, --version")}  ${e("version")}`)},I=()=>{let n=h().version;console.log(`${e("version")} ${s.cyan(n)}`)};g.name("nrs").description(e("intro")).version(h().version,"-v, --version",e("version")).option("-l, --list",e("listScripts")).option("-a, --advanced",e("advancedMode")).option("-s, --search <keyword>",e("searchScripts")).option("-r, --recent",e("runRecentScript")).option("-rl, --recent-list",e("listRecentScripts")).option("--list-all",e("listAllScripts")).action(async(n,t)=>{if(t.args.length>0){console.log(s.yellow(e("unknownCommand",{command:t.args[0]}))),$();return}let r=process.cwd();if(n.version){I();return}if(n.lang){n.lang==="zh"||n.lang==="en"?(L=n.lang,console.log(e("languageChanged"))):(console.log(s.yellow(e("unsupportedLanguage"))),console.log(s.cyan(e("changeLanguage"))));return}if(n.listAll){let o=JSON.parse(v("./package.json","utf8")).scripts||{};console.log(s.cyan(`
${e("availableScripts")}`)),Object.entries(o).forEach(([a,u])=>{console.log(`  ${s.green(a)}: ${s.dim(u)}`)})}else if(n.recentList)U(r);else if(n.recent){let c=g.args.find(o=>o.startsWith("--"))?parseInt(g.args.find(o=>o.startsWith("--")).slice(2))-1:0;await y({recentIndex:c,projectPath:r})}else n.list||n.advanced||n.search?await y({searchTerm:n.search,advanced:n.advanced,listOnly:n.list,projectPath:r}):$()});g.parse(process.argv);process.argv.slice(2).length||g.outputHelp();A.exports={loadHistory:b,saveHistory:M,getProjectPath:q,getScripts:E,runSelectedScript:O,runScript:y,showHelp:$,showVersion:I}});export default K();
